<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="it">

<head>
    <meta charset="UTF-8">
    <title th:text="${pageTitle}">Impianto</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark" style="background-color:#214F8D;">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="/">
                <img src="/img/logo-chiavaroli-ascensori.png" style="height:32px;" class="me-2">
                <span class="d-none d-sm-inline" style="font-weight:700; text-transform:uppercase;">Gestione
                    Impianti</span>
            </a>
        </div>
    </nav>

    <main class="container my-3">
        <!-- Tasto per tornare indietro -->
        <a th:href="@{/luoghi/{id}(id=${impianto.luogo.id})}" class="btn btn-link btn-sm ps-0">
            &larr; Torna agli impianti di
            <span th:text="${impianto.luogo.nome}">Pescara</span>
        </a>

        <!-- Titolo -->
        <h1 class="h5 mb-2" th:text="${impianto.nome}" style="color:#214F8D; font-weight:700;">ASC-PE-001</h1>

        <p class="small mb-1">
            <strong>Indirizzo:</strong>
            <span th:text="${impianto.indirizzo}"></span>
        </p>

        <p class="small mb-3">
            <strong>Stato:</strong>
            <span th:text="${impianto.stato}"></span>
        </p>

        <div class="mb-3 d-flex gap-2">
            <a th:href="@{/impianti/{id}/interventi/nuovo(id=${impianto.id})}" class="btn btn-sm"
                style="background-color:#C73834; color:#fff; font-weight:600;">
                + Aggiungi intervento
            </a>

            <a th:href="@{/impianti/{id}/modifica(id=${impianto.id})}" class="btn btn-outline-secondary btn-sm">
                Modifica impianto
            </a>
        </div>



        <!-- Totale costi -->
        <div class="alert alert-secondary">
            Totale costi interventi completati:
            <strong th:text="${#numbers.formatDecimal(totaleCosti, 2, 'COMMA', 2, 'POINT')}">0.00</strong> €
        </div>

        <h2 class="h6 mt-4 mb-2">Interventi</h2>

        <div th:each="intervento : ${interventi}" class="card mb-2 shadow-sm">
            <div class="card-body">

                <div class="d-flex justify-content-between">
                    <strong th:text="${intervento.tipo}"></strong>
                    <span class="badge bg-light text-dark" th:text="${intervento.stato}"></span>
                </div>

                <div class="d-flex justify-content-end mt-2">
                    <a th:href="@{/interventi/{id}/modifica(id=${intervento.id})}"
                        class="btn btn-outline-secondary btn-sm">
                        Modifica
                    </a>
                </div>

                <p class="small text-muted mb-1" th:text="${intervento.descrizione}"></p>

                <p class="small mb-0">
                    <strong>Costo:</strong>
                    <span th:text="${intervento.costo != null ? intervento.costo : '0.00'}"></span> €
                </p>
            </div>
        </div>

    </main>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>